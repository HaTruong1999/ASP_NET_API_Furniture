@model List<Buyer.Mvc.Models.OrderHeader>
@{
    ViewData["Title"] = "Home Page";
}
@using System.Globalization;

@section CSS{
    <link rel="stylesheet" href="~/css/home.css" />
}

<section>
    <div class="container1" style="padding: 10px; margin-top: 10px;">
        <form >
            <div class="title" style="text-align: center; font-size: 20px; font-weight: bold;"><p style="margin-bottom: 0;">History Order</p></div>
            <a href="/Home/Index" class="btn btn-primary btn-sm">Continue Shopping</a>
            <table id="example" class="table table-striped table-bordered table-sm infor-table"
                   data-show-export="true"
                   data-show-toggle="true"
                   data-show-columns="true"
                   data-export-data-type="excel"
                   data-click-to-select="true"
                   data-height="500"
                   data-pagination="true"
                   data-export-types=['excel']
                   data-page-list="[10, 25, 50, 100, 200, All]">
                <thead class="thead-dark">
                    <tr>
                        <th>View Detail</th>
                        <th>Order Code</th>
                        <th>Date Order</th>
                        <th>Last Changed Order</th>
                        <th>Status</th>
                        <th>Quantity</th>
                        <th>Total Amount</th>
                    </tr>
                </thead>
                <tbody id="bodyTotalOrder">
                    @foreach (var item in Model)
                    {
                    <tr>
                        <td><a asp-action="DetailOrder" asp-route-id="@item.OrderID" class="btn btn-primary btn-sm ViewDetailOrder">View</a></td>
                        <td>@item.OrderID</td>
                        <td>@item.OrderDate</td>
                        <td>@item.LastChangedDate</td>
                        @if (item.Status.Trim().Equals("Canceled"))
                        {
                            <td style="color: red;">@item.Status</td>
                        }
                        else
                        {
                            <td>@item.Status</td>
                        }
                        <td>@String.Format(CultureInfo.InvariantCulture, "{0:0,0}", item.Quantity)</td>
                        <td>@String.Format(CultureInfo.InvariantCulture, "{0:0,0}", item.TotalAmount)</td>
                    </tr>
                    }
                </tbody>
            </table>
        </form>
    </div>
</section>

@*<form method="post" style="display: none">
    <input name="OrderID" id="OrderID" style="display: none" value="0">
    <button asp-action="ViewDetailOrder" class="btn btn-primary btn-sm" id="btnViewDetailOrder"></button>
</form>*@

<div class="modal" id="confirmCancleOrder" style="background-color: rgb(79 77 77 / 30%);">
    <div class="modal-dialog">
        <div class="modal-content" style="margin-top: 50%;">
            <div class="modal-header">
                <h4 class="modal-title" id="addTargetLabel">Are you sure to cancle this order?</h4>
            </div>
            <div class="modal-body">
                <form method="post">
                    <input name="OrderIDCancle" id="OrderIDCancle" style="display: none" value="0">
                    <button asp-action="CancleOrder" class="btn btn-primary btn-sm">OK</button>
                    <button id="btnCloseCancelOrder" type="button" class="btn btn-danger btn-sm" data-dismiss="modal">Cancel</button>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        $(function () {
            $('#example').bootstrapTable('destroy').bootstrapTable({
                toolbar: '.toolbar',
                search: true,
                showColumns: true,
                fixedColumns: true,
                fixedNumber: 0,
                fixedRightNumber: 0
            });

            $('#example1').bootstrapTable('destroy').bootstrapTable({
                toolbar: '.toolbar',
                search: true,
                showColumns: true,
                fixedColumns: true,
                fixedNumber: 0,
                fixedRightNumber: 0
            });

            //$(".ViewDetailOrder").on("click", function (e) {
            //    e.preventDefault();
            //    e.stopPropagation();
            //    $("#OrderID").val($(this).attr('data-OrderID'));
            //    $("#btnViewDetailOrder").click();
            //}); 

            $("#btnCancleOrder").on("click", function (e) {
                e.preventDefault();
                e.stopPropagation();
                $("#OrderIDCancle").val($(this).attr('data-OrderID'));
                $("#confirmCancleOrder").fadeIn(300);
            });

            $("#btnCloseCancelOrder").on("click", function (e) {
                e.preventDefault();
                e.stopPropagation();
                $("#confirmCancleOrder").fadeOut(300);
            });
        }); 
    </script>
}